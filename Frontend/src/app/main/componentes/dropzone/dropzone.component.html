<div>
  <p-card header="Carga de datos admon sueldos.">
    
    <p>
        Para iniciar el proceso de carga de <strong>admon sueldos</strong>, seleccione un archivo en formato
        <strong>Excel (.xlsx)</strong> utilizando el botón que aparece a continuación.
        <br>
        Esto le permitirá buscar y elegir el archivo correspondiente desde su equipo.
    </p>


    <p-fileUpload
      mode="advanced"
      name="file"
      accept=".csv,.xlsx"
      maxFileSize="5000000"
      [chooseLabel]="previewData.length ? 'Seleccione otro archivo para cargar.' : 'Seleccione un archivo para iniciar la carga.'"
      [auto]="true"
      [customUpload]="true"
      [showUploadButton]="false"
      [showCancelButton]="false"
      (onSelect)="onFileSelect($event)">
    </p-fileUpload>

    <!-- PREVIEW -->
      <hr *ngIf="previewData.length">
      <div class="preview-header" *ngIf="previewData.length">
        <h3 class="preview-title">
          Vista previa del archivo: {{fileName}}
        </h3>
      
        <p-button
          class="preview-btn"
          [label]="flagPreview ? 'Ocultar vista previa' : 'Mostrar vista previa'"
          icon="pi pi-eye"
          severity="success"
          (onClick)="flagPreview = !flagPreview">
        </p-button>
      </div>
      

    <p-table
      *ngIf="flagPreview"
      [value]="previewData"
      responsiveLayout="scroll"
      class="p-datatable-sm p-datatable-gridlines p-datatable-striped">

      <ng-template pTemplate="header">
        <tr>
          <th *ngFor="let col of columns">{{ col }}</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-row>
        <tr>
          <td *ngFor="let col of columns">{{ row[col] }}</td>
        </tr>
      </ng-template>

    </p-table>

    <!-- INFO -->
    <div class="mt-3 text-center" *ngIf="flagPreview">
      <p>Mostrando los primeros {{ previewData.length }} registros.</p>
    </div>

    <!-- BOTÓN FINAL -->
    <div class="mt-3 text-center" *ngIf="previewData.length">
      <button
        pButton
        label="Iniciar carga de datos"
        icon="pi pi-send"
        class="p-button-success"
        (click)="sendToApi()">
      </button>
    </div>
  </p-card>
</div>
